import{l as U,m as L,q,E as x,n as O,_ as B}from"#entry";import{d as C,E as N,q as I,g as M,G as F,v as $,l as z,r as H,F as X,a4 as G,M as J,O as g,aG as Q,a2 as f,X as v,at as b,N as Y,u as V,$ as S,a0 as K}from"./CNHhKriD.js";import{i as W,u as Z}from"./CAK6LHbS.js";import"./Ck70_2Af.js";function ee(e,i){if(typeof e!="string")throw new TypeError("argument str must be a string");const o={},t=i||{},s=t.decode||te;let a=0;for(;a<e.length;){const n=e.indexOf("=",a);if(n===-1)break;let l=e.indexOf(";",a);if(l===-1)l=e.length;else if(l<n){a=e.lastIndexOf(";",n-1)+1;continue}const c=e.slice(a,n).trim();if(t?.filter&&!t?.filter(c)){a=l+1;continue}if(o[c]===void 0){let u=e.slice(n+1,l).trim();u.codePointAt(0)===34&&(u=u.slice(1,-1)),o[c]=oe(u,s)}a=l+1}return o}function te(e){return e.includes("%")?decodeURIComponent(e):e}function oe(e,i){try{return i(e)}catch{return e}}const T=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function R(e,i,o){const t=o||{},s=t.encode||encodeURIComponent;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!T.test(e))throw new TypeError("argument name is invalid");const a=s(i);if(a&&!T.test(a))throw new TypeError("argument val is invalid");let n=e+"="+a;if(t.maxAge!==void 0&&t.maxAge!==null){const l=t.maxAge-0;if(Number.isNaN(l)||!Number.isFinite(l))throw new TypeError("option maxAge is invalid");n+="; Max-Age="+Math.floor(l)}if(t.domain){if(!T.test(t.domain))throw new TypeError("option domain is invalid");n+="; Domain="+t.domain}if(t.path){if(!T.test(t.path))throw new TypeError("option path is invalid");n+="; Path="+t.path}if(t.expires){if(!ie(t.expires)||Number.isNaN(t.expires.valueOf()))throw new TypeError("option expires is invalid");n+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(n+="; HttpOnly"),t.secure&&(n+="; Secure"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():t.priority){case"low":{n+="; Priority=Low";break}case"medium":{n+="; Priority=Medium";break}case"high":{n+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:{n+="; SameSite=Strict";break}case"lax":{n+="; SameSite=Lax";break}case"strict":{n+="; SameSite=Strict";break}case"none":{n+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return t.partitioned&&(n+="; Partitioned"),n}function ie(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function m(e){if(typeof e!="object")return e;var i,o,t=Object.prototype.toString.call(e);if(t==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){o=new e.constructor;for(i in e)e.hasOwnProperty(i)&&o[i]!==e[i]&&(o[i]=m(e[i]))}else{o={};for(i in e)i==="__proto__"?Object.defineProperty(o,i,{value:m(e[i]),configurable:!0,enumerable:!0,writable:!0}):o[i]=m(e[i])}return o}if(t==="[object Array]"){for(i=e.length,o=Array(i);i--;)o[i]=m(e[i]);return o}return t==="[object Set]"?(o=new Set,e.forEach(function(s){o.add(m(s))}),o):t==="[object Map]"?(o=new Map,e.forEach(function(s,a){o.set(m(a),m(s))}),o):t==="[object Date]"?new Date(+e):t==="[object RegExp]"?(o=new RegExp(e.source,e.flags),o.lastIndex=e.lastIndex,o):t==="[object DataView]"?new e.constructor(m(e.buffer)):t==="[object ArrayBuffer]"?e.slice(0):t.slice(-6)==="Array]"?new e.constructor(e):e}const ne={path:"/",watch:!0,decode:e=>U(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))},A=globalThis.cookieStore;function re(e,i){const o={...ne,...i};o.filter??=u=>u===e;const t=D(o)||{};let s;o.maxAge!==void 0?s=o.maxAge*1e3:o.expires&&(s=o.expires.getTime()-Date.now());const a=s!==void 0&&s<=0,n=a||t[e]===void 0||t[e]===null,l=m(a?void 0:t[e]??o.default?.()),c=s&&!a?le(l,s,o.watch&&o.watch!=="shallow"):C(l);{let u=null;try{!A&&typeof BroadcastChannel<"u"&&(u=new BroadcastChannel(`nuxt:cookies:${e}`))}catch{}const p=(d=!1)=>{!d&&(o.readonly||W(c.value,t[e]))||(se(e,c.value,o),t[e]=m(c.value),u?.postMessage({value:o.encode(c.value)}))},r=d=>{const y=d.refresh?D(o)?.[e]:o.decode(d.value);w=!0,c.value=y,t[e]=m(y),$(()=>{w=!1})};let w=!1;const k=!!M();if(k&&N(()=>{w=!0,p(),u?.close()}),A){const d=y=>{const E=y.changed.find(_=>_.name===e),j=y.deleted.find(_=>_.name===e);E&&r({value:E.value}),j&&r({value:null})};A.addEventListener("change",d),k&&N(()=>A.removeEventListener("change",d))}else u&&(u.onmessage=({data:d})=>r(d));o.watch&&I(c,()=>{w||p()},{deep:o.watch!=="shallow"}),n&&p(n)}return c}function D(e={}){return ee(document.cookie,e)}function ae(e,i,o={}){return i==null?R(e,i,{...o,maxAge:-1}):R(e,i,o)}function se(e,i,o={}){document.cookie=ae(e,i,o)}const P=2147483647;function le(e,i,o){let t,s,a=0;const n=o?C(e):{value:e};return M()&&N(()=>{s?.(),clearTimeout(t)}),F((l,c)=>{o&&(s=I(n,c));function u(){a=0,clearTimeout(t);const p=i-a,r=p<P?p:P;t=setTimeout(()=>{if(a+=r,a<i)return u();n.value=void 0,c()},r)}return{get(){return l(),n.value},set(p){u(),n.value=p,c()}}})}const ce={class:"login-container"},ue={class:"login-panel"},de={class:"panel-right"},fe={class:"form-extras"},pe={class:"links"},me=z({__name:"login",setup(e){const i=C(),o=re("login_username"),t=H({username:o.value||"",password:"",remember:!!o.value}),s={username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},a=C(!1),n=C(!1),l=()=>{i.value?.validate(async p=>{if(p){a.value=!0;try{const{error:r}=await Z("/api/auth/login",{method:"POST",server:!1,body:{username:t.username,password:t.password}},"$1eMTWX2UtQ");if(r.value)throw r.value;t.remember?o.value=t.username:o.value=null,x.success("登录成功"),O("/home")}catch{try{x.closeAll()}catch{}x.error({message:"登录失败：账号或密码错误",duration:2e3,showClose:!0})}finally{a.value=!1}}})},c=()=>{x.info("忘记密码：请联系管理员或走找回流程")},u=()=>{O("/register")};return X(()=>{typeof document<"u"&&document.body.classList.add("no-scroll")}),G(()=>{typeof document<"u"&&document.body.classList.remove("no-scroll")}),(p,r)=>{const w=b("el-input"),k=b("el-form-item"),d=b("el-button"),y=b("el-checkbox"),E=b("el-divider"),j=b("el-form"),_=b("el-card");return Y(),J("div",ce,[g("div",ue,[r[9]||(r[9]=Q('<div class="panel-left" data-v-e6c87467><div class="brand" data-v-e6c87467><div class="brand-logo" data-v-e6c87467>Nuxt</div><div class="brand-title" data-v-e6c87467>企业后台管理系统</div><div class="brand-desc" data-v-e6c87467>基于 Nuxt + Element Plus，提供高效的中后台体验</div></div></div>',1)),g("div",de,[f(_,{class:"login-card",shadow:"never"},{default:v(()=>[r[8]||(r[8]=g("div",{class:"card-header"},[g("div",{class:"logo"},"EP"),g("div",{class:"title"},[g("h2",null,"欢迎登录"),g("p",null,"请输入您的账号和密码")])],-1)),f(j,{ref_key:"formRef",ref:i,model:t,rules:s,"label-position":"top"},{default:v(()=>[f(k,{label:"账号",prop:"username"},{default:v(()=>[f(w,{modelValue:t.username,"onUpdate:modelValue":r[0]||(r[0]=h=>t.username=h),placeholder:"请输入账号","prefix-icon":V(L),clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),f(k,{label:"密码",prop:"password"},{default:v(()=>[f(w,{modelValue:t.password,"onUpdate:modelValue":r[2]||(r[2]=h=>t.password=h),type:n.value?"text":"password",placeholder:"请输入密码","prefix-icon":V(q),clearable:""},{suffix:v(()=>[f(d,{link:"",type:"primary",onClick:r[1]||(r[1]=h=>n.value=!n.value)},{default:v(()=>[S(K(n.value?"隐藏":"显示"),1)]),_:1})]),_:1},8,["modelValue","type","prefix-icon"])]),_:1}),g("div",fe,[f(y,{modelValue:t.remember,"onUpdate:modelValue":r[3]||(r[3]=h=>t.remember=h)},{default:v(()=>[...r[4]||(r[4]=[S("记住我",-1)])]),_:1},8,["modelValue"]),g("div",pe,[f(d,{link:"",type:"primary",onClick:c},{default:v(()=>[...r[5]||(r[5]=[S("忘记密码",-1)])]),_:1}),f(E,{direction:"vertical"}),f(d,{link:"",type:"primary",onClick:u},{default:v(()=>[...r[6]||(r[6]=[S("注册账号",-1)])]),_:1})])]),f(d,{class:"submit-btn",type:"primary",size:"large",loading:a.value,onClick:l,block:""},{default:v(()=>[...r[7]||(r[7]=[S(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1})])])])}}}),be=B(me,[["__scopeId","data-v-e6c87467"]]);export{be as default};
