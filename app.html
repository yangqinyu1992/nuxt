<!DOCTYPE html>
<html {{ HTML_ATTRS }}>
  <head {{ HEAD_ATTRS }}>
    {{ HEAD }}
    <style>
      .splash-screen {
        position: fixed;
        inset: 0;
        display: grid;
        place-items: center;
        background: var(--bg-page, #fff);
        z-index: 99999;
        transition: opacity .25s ease;
      }
      .splash-inner {
        display: grid;
        gap: 12px;
        justify-items: center;
        color: var(--text-1, #333);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol";
      }
      .splash-spinner {
        width: 44px; height: 44px;
        border-radius: 50%;
        border: 3px solid rgba(0,0,0,.12);
        border-top-color: #409EFF;
        animation: spin 0.8s linear infinite;
      }
      [data-theme='dark'] .splash-spinner {
        border-color: rgba(255,255,255,.15);
        border-top-color: #409EFF;
      }
      .splash-title { font-weight: 600; font-size: 14px; opacity: .9; }
      .splash-tip { font-size: 12px; opacity: .6; }
      .splash-screen.hide { opacity: 0; pointer-events: none; }
      @keyframes spin { to { transform: rotate(360deg) } }
    </style>
    <script>
      // 预置主题 + 内联关键 CSS 变量，彻底避免首屏样式闪回
      (function() {
        try {
          var KEY = 'dashboard_theme';
          var saved = localStorage.getItem(KEY);
          var theme = (saved === 'dark' || saved === 'light') ? saved : 'light';
          document.documentElement.setAttribute('data-theme', theme);
          // 动态注入关键 CSS 变量（与全局 theme.css 一致的最小子集）
          var cssLight = ':root{--bg-page:#f5f7fa;--bg-card:#ffffff;--text-1:#1f2937;--text-2:#6b7280;--border:#e5e7eb}';
          var cssDark  = ':root{--bg-page:#111318;--bg-card:#16181d;--text-1:#e5e7eb;--text-2:#9ca3af;--border:#2a2e36}';
          var base     = 'html,body{height:100%;overflow:hidden}';
          var style = document.createElement('style');
          style.id = 'theme-inline';
          style.textContent = (theme === 'dark' ? cssDark : cssLight) + base;
          document.head.appendChild(style);
        } catch (e) {}
      })();
    </script>
  </head>
  <body {{ BODY_ATTRS }}>
    <div id="app-splash" class="splash-screen">
      <div class="splash-inner">
        <div class="splash-spinner"></div>
        <div class="splash-title">正在加载资源...</div>
        <div class="splash-tip">首次进入可能稍有等待，请稍候</div>
      </div>
    </div>
    {{ APP }}
  </body>
</html>